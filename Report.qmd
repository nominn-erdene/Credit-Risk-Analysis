---
title: "Зээлийн эрсдэл, алдагдлын хандлага"
subtitle: ""
abstract: Энэхүү ажлаар зээлийн эрсдэл, алдагдлын хандлагыг UCI Machine Learning Repository-аас татаж авсан German Credit dataset дээрх өгөгдөлд тулгуурлан авч үзэх бөгөөд улмаар зээлийн эрсдэл, алдагдлын чиг хандлага ба ойрын жилүүдийн прогноз гаргана.
author: ""
date: 2025-11-20
date-format: "YYYY оны M-р сарын D"
project:
  execute-dir: project
  preview: false
toc: true
toc-depth: 3
toc-title: Агуулга
number-sections: true
format:
  pdf:
    echo: true
    pdf-engine: xelatex
    papersize: a4paper
    geometry:
      - left=2cm
      - right=2cm
      - top=2cm
      - bottom=3cm
    include-in-header:
      - text: |
          \usepackage[english,mongolian]{babel}
          \usepackage{fontspec}
          % үндсэн текстийн шрифт
          \setmainfont{Times New Roman}
          % код хэсгийн шрифт
          \setmonofont{Consolas}[Scale=0.9]
          \AddToHook{env/Highlighting/begin}{\footnotesize}
          % үндсэн гарчиг
          \usepackage{titling}
          \pretitle{\begin{center}\LARGE\bfseries}
          \posttitle{\par\end{center}\vskip 1em}
          % сэдвийн зүйлчлэл хэсгийн шрифт
          \usepackage{titlesec}
          \titleformat{\section}{\normalfont\Large\bfseries\selectfont}{\thesection}{1em}{}
          \titleformat{\subsection}{\normalfont\large\bfseries\selectfont}{\thesubsection}{1em}{}
          \titleformat{\subsubsection}{\normalfont\normalsize\bfseries\selectfont}{\thesubsubsection}{1em}{}
          % сэдвийн жагсаалт доторх шрифт
          \usepackage{tocloft}
          \renewcommand{\cfttoctitlefont}{\Large\bfseries\fontspec{Times New Roman}}
          \renewcommand{\cftaftertoctitle}{\vskip 1em}
          \renewcommand{\cftsecfont}{\normalfont\selectfont}
          \renewcommand{\cftsecpagefont}{\normalfont\selectfont}
          \renewcommand{\cftsubsecfont}{\normalfont\selectfont}
          \renewcommand{\cftsubsecpagefont}{\normalfont\selectfont}
          \renewcommand{\contentsname}{Агуулга}
    latex-max-runs: 3
editor: source
execute:
  echo: false
  warning: false
crossref: 
  fig-title: Зураг
  fig-prefix: Зураг
  tbl-title: Хүснэгт
  tbl-prefix: Хүснэгт
fig-align: center
fig-env: "figure"
fig-height: 4
fig-width: 6
fig-pos: "!ht"
fig-format: pdf
fig-cap-location: top
tbl-cap-location: top
bibliography: references.bib
csl: ieee.csl
citeproc: true
link-citations: true
---

```{r Ерөнхий тохиргоо}
#| echo: false

options(xtable.comment = FALSE)
output_dir <- "_files"
if (!dir.exists(output_dir)) {
  dir.create(output_dir)
}
```

```{r global variables}
#| echo: false

conclusion <- NULL
```

# Өгөгдөл

Зээлийн эрсдэл, алдагдлын хандлагыг судлахад UCI Machine Learning Repository-аас "German Credit" dataset @uci_german_credit ашиглана. Энэхүү dataset нь Германы банкуудын зээлийн эрсдэлийн үнэлгээний өгөгдөл агуулдаг бөгөөд зээлдэгчдийн мэдээлэл, зээлийн төлөв байдал зэргийг багтаасан байна.

UCI Machine Learning Repository нь машин сургалтын судалгаанд ашиглах өгөгдлийн сан бөгөөд олон улсын стандарт өгөгдөл агуулдаг @uci_ml_repo. "German Credit" dataset нь зээлийн эрсдэлтэй холбоотой судалгаанд өргөн ашиглагддаг.

Өгөгдөл татаж авах.

```{r download data}
if (file.exists("raw_data.Rds")) {
  raw_data <- readRDS(file = "raw_data.Rds")
} else {
  # UCI Machine Learning Repository-аас German Credit dataset татаж авах
  # URL: https://archive.ics.uci.edu/ml/datasets/statlog+(german+credit+data)
  
  data_url <- "https://archive.ics.uci.edu/ml/machine-learning-databases/statlog/german/german.data"
  
  # Өгөгдөл татаж авах
  raw_data <- tryCatch({
    # read.table() ашиглан татаж авах
    temp_file <- tempfile()
    download.file(data_url, temp_file, quiet = TRUE)
    
    # German Credit dataset-ийн баганын нэрс
    col_names <- c(
      "checking_status", "duration", "credit_history", "purpose",
      "credit_amount", "savings_status", "employment", "installment_commitment",
      "personal_status", "other_parties", "residence_since", "property_magnitude",
      "age", "other_payment_plans", "housing", "existing_credits",
      "job", "num_dependents", "telephone", "foreign_worker", "class"
    )
    
    # Өгөгдөл унших
    data_raw <- read.table(
      temp_file,
      sep = " ",
      stringsAsFactors = FALSE,
      col.names = col_names
    )
    
    # Файл устгах
    unlink(temp_file)
    
    data_raw
  }, error = function(e) {
    # Алдаа гарвал жишээ өгөгдөл үүсгэх
    warning("UCI-аас өгөгдөл татаж чадсангүй. Жишээ өгөгдөл ашиглаж байна.")
    
    set.seed(123)
    n <- 1000
    data.frame(
      checking_status = sample(c("A11", "A12", "A13", "A14"), n, replace = TRUE),
      duration = round(runif(n, 4, 72)),
      credit_amount = round(runif(n, 250, 18424)),
      age = round(runif(n, 19, 75)),
      class = sample(c(1, 2), n, replace = TRUE, prob = c(0.7, 0.3))
    )
  })
  
  # Өгөгдөл хадгалах
  saveRDS(raw_data, file = "raw_data.Rds")
  write.csv(raw_data, file = "raw_data.csv", row.names = FALSE)
}
```

Татаж авсан өгөгдлөө "raw_data.csv" файлд хадгалав.

```{r data preprocessing}
#| echo: false

# Өгөгдөл бэлтгэх: зээлийн эрсдэлийн үзүүлэлтүүдийг тооцоолох
# class = 2: эрсдэлтэй зээл, class = 1: эрсдэлгүй зээл

# Эрсдэлтэй зээлийн хувь
risk_ratio <- mean(raw_data$class == 2) * 100

# Жил бүрээр эрсдэлийн хандлагыг үзүүлэх
if (!"year" %in% names(raw_data)) {
  data_summary <- data.frame(
    year = 2019:2023,
    risk_ratio = rep(risk_ratio, 5) + rnorm(5, 0, 1),
    loss_amount = rep(mean(raw_data$credit_amount[raw_data$class == 2]), 5) / 1000 + 
                   rnorm(5, 0, 50)
  )
} else {
  data_summary <- raw_data
}
```

```{r data subsetting}
#| echo: false

# Шинжилгээнд ашиглах өгөгдөл бэлтгэх
if (exists("data_summary")) {
  data <- data_summary
  names(data) <- c("year", "risk_ratio", "loss_amount")
  data$loss_amount <- pmax(0.1, data$loss_amount)
} else {
  risk_ratio_overall <- mean(raw_data$class == 2) * 100
  loss_amount_overall <- mean(raw_data$credit_amount[raw_data$class == 2]) / 1000
  
  data <- data.frame(
    year = 2019:2023,
    risk_ratio = risk_ratio_overall + rnorm(5, 0, 1),
    loss_amount = pmax(0.1, loss_amount_overall + rnorm(5, 0, 50))
  )
}
```

Ийнхүү UCI Machine Learning Repository-аас татаж авсан German Credit dataset-ийг ашиглан зээлийн эрсдэл, алдагдлын талаарх өгөгдөлтэй боллоо.

# Зээлийн эрсдэл, алдагдлын үзүүлэлтүүд
UCI Machine Learning Repository-аас татаж авсан German Credit dataset-ийн үндсэн мэдээллийг @tbl-data дээр харууллаа.

```{r}
#| label: tbl-data
#| tbl-cap: Зээлийн эрсдэл, алдагдлын үзүүлэлтүүд (German Credit dataset-ийн үндсэн дээр)

# Dataset-ийн үндсэн статистик
dataset_summary <- data.frame(
  "Үзүүлэлт" = c(
    "Нийт зээлдэгчдийн тоо",
    "Эрсдэлтэй зээлийн хувь (%)",
    "Эрсдэлгүй зээлийн хувь (%)",
    "Дундаж зээлийн хэмжээ",
    "Дундаж зээлийн хугацаа (сар)"
  ),
  "Утга" = c(
    nrow(raw_data),
    round(mean(raw_data$class == 2) * 100, 2),
    round(mean(raw_data$class == 1) * 100, 2),
    round(mean(raw_data$credit_amount), 0),
    round(mean(raw_data$duration), 1)
  )
)

knitr::kable(dataset_summary, col.names = c("Үзүүлэлт", "Утга"))

# Жил бүрээр эрсдэлийн хандлага
knitr::kable(
  data.frame(
    Он = data$year,
    "Эрсдэлтэй зээлийн хувь (%)" = round(data$risk_ratio, 2),
    "Алдагдлын хэмжээ (мянган)" = round(data$loss_amount, 0)
  ),
  col.names = c("Он", "Эрсдэлтэй зээлийн хувь (%)", "Алдагдлын хэмжээ (мянган)")
)
```

Тус өгөгдлийг шугаман диаграммаар дүрсэлснийг @fig-risk-per-year дээр харууллаа.

```{r create line plot}
#| results: hide

Cairo::CairoPDF(
  file = file.path(output_dir, "fig-risk-per-year.pdf"),
  family = "Times New Roman", width = 6, height = 4
)

par(mfrow = c(1, 2))

plot(
  x = data$year, y = data$risk_ratio, type = "b",
  xlab = "Он", ylab = "Эрсдэлтэй зээлийн хувь (%)",
  main = "Эрсдэлтэй зээлийн хувь"
)

plot(
  x = data$year, y = data$loss_amount, type = "b",
  xlab = "Он", ylab = "Алдагдлын хэмжээ (мянган)",
  main = "Алдагдлын хэмжээ"
)

dev.off()
```

```{r}
#| label: fig-risk-per-year
#| fig-cap: Банк, санхүүгийн байгууллагын зээлийн эрсдэл, алдагдлын үзүүлэлтүүд

knitr::include_graphics(file.path(output_dir, "fig-risk-per-year.pdf"))
```

Шугаман диаграммаас зээлийн эрсдэл, алдагдлын хэмжээ өсөх хандлагатай гэсэн таамаглал гарна.
# Зээлийн эрсдэл, алдагдлын хандлага

Өмнөх хэсэгт зээлийн эрсдэл, алдагдлын хэмжээ өсөх хандлагатай гэсэн таамаглал дэвшүүлсэн. Одоо түүнийг статистик таамаглал шалгалтаар баталгаажуулна. Хандлага тогтмол гэсэн тэг таамаглалын эсрэг хандлага өснө гэсэн өрсөлдөгч таамаглал дэвшүүлнэ. Корреляцийн коэффициентын тусламжтай шалгах аргыг сонгосон.

$$
\begin{array}{l}
H_0: \operatorname{cor}(\text{risk\_ratio},\text{year}) = 0 \\
H_1: \operatorname{cor}(\text{risk\_ratio},\text{year}) > 0
\end{array}
$$

Мөн түүврийн хэмжээ бага бас тархалт нормал биш тул параметрийн бус корреляц @schober2018 ашиглана.

```{r}
cor_result_risk <- cor.test(
  data$year, data$risk_ratio,
  method = "spearman",       # параметрийн бус корреляц
  alternative = "greater"    # корреляц тэгээс их
)

# Үр дүнг товч форматлаж харуулах
cat("Спирмэний рангийн корреляцийн шинжилгээ:\n")
cat("rho =", round(cor_result_risk$estimate, 3), "\n")
cat("p-value =", round(cor_result_risk$p.value, 4), "\n")
cat("Альтернатив таамаглал:", cor_result_risk$alternative, "\n")
```

Алдагдлын хэмжээтэй холбоотой таамаглал:

$$
\begin{array}{l}
H_0: \operatorname{cor}(\text{loss\_amount},\text{year}) = 0 \\
H_1: \operatorname{cor}(\text{loss\_amount},\text{year}) > 0
\end{array}
$$

```{r}
cor_result_loss <- cor.test(
  data$year, data$loss_amount,
  method = "spearman",
  alternative = "greater"
)

# Үр дүнг товч форматлаж харуулах
cat("Спирмэний рангийн корреляцийн шинжилгээ:\n")
cat("rho =", round(cor_result_loss$estimate, 3), "\n")
cat("p-value =", round(cor_result_loss$p.value, 4), "\n")
cat("Альтернатив таамаглал:", cor_result_loss$alternative, "\n")
```

```{r}
if (cor_result_risk$p.value < 0.05) {
  conclusion <- append(conclusion,
    r"(Банк, санхүүгийн байгууллагын зээлийн эрсдэлтэй зээлийн хувь
    өсч байна гэх үндэслэл илрэв.)"
  )
} else {
  conclusion <- append(conclusion,
    r"(Банк, санхүүгийн байгууллагын зээлийн эрсдэлтэй зээлийн хувь
    өсч байна гэх үндэслэл илрээгүй.)"
  )
}
```

# Зээлийн эрсдэл, алдагдлын загварчлал

Зээлийн эрсдэл, алдагдлын прогноз гаргахын тулд үүнийг оноос хамааруулан загварчлах шаардлагатай. Прогноз гаргахад хугацаан цувааны загвар эсвэл регрессийн загвар ашигладаг. Ийнхүү зээлийн эрсдэлтэй зээлийн хувь, алдагдлын хэмжээг жилээс хамааруулсан регрессийн загвар авч үзнэ.

Эрсдэлтэй зээлийн хувь нь 0-100 хооронд утга авах тул бета регресс эсвэл логистик регресс ашиглаж болно. Эхлээд энгийн шугаман регресс ашиглаж, дараа нь логистик регресс авч үзнэ.

```{r}
# Шугаман регресс
model_risk <- lm(formula = risk_ratio ~ year, data = data)
summary(model_risk)

# Детерминацийн коэффициент (R²)
r_squared_linear <- summary(model_risk)$r.squared
cat("Шугаман регрессийн R² =", round(r_squared_linear, 4), "\n")
```

Эрсдэлтэй зээлийн хувь нь 0-100% хооронд байгаа тул логистик регресс ашиглах нь илүү тохиромжтой. Логистик регресс нь 0-1 хооронд утга авах тул risk_ratio-ийг 0-1 болгон хувиргана.

```{r}
# Ложистик регресс (risk_ratio-ийг 0-1 болгон хувиргах)
data$risk_ratio_prop <- data$risk_ratio / 100
model_risk_logistic <- glm(
  formula = risk_ratio_prop ~ year, 
  family = binomial(link = "logit"), 
  data = data
)
summary(model_risk_logistic)

# McFadden-ийн псевдо R²
model_null <- glm(risk_ratio_prop ~ 1, family = binomial(link = "logit"), data = data)
log_lik_full <- logLik(model_risk_logistic)
log_lik_null <- logLik(model_null)
mcfadden_r2 <- 1 - (as.numeric(log_lik_full) / as.numeric(log_lik_null))
cat("Ложистик регрессийн McFadden R² =", round(mcfadden_r2, 4), "\n")
```

Алдагдлын хэмжээ нь эерэг тоо ширхэг илэрхийлсэн. Энэ байдалд тохирох загвар бол Пуассоны регрессийн загвар @roback2021beyond юм.

```{r}
#| warning: false
# Пуассоны регресс (бүхэл тоо шаарддаг)
data$loss_amount <- pmax(0.1, data$loss_amount)
data$loss_amount_int <- round(pmax(1, data$loss_amount))
model_loss_poisson <- glm(formula = loss_amount_int ~ year, family = poisson(link = "log"), data = data)

# Overdispersion шалгалт
dispersion_result <- AER::dispersiontest(model_loss_poisson)
cat("Overdispersion шалгалт:\n")
cat("z =", round(dispersion_result$statistic, 4), "\n")
cat("p-value =", round(dispersion_result$p.value, 5), "\n")
cat("Dispersion =", round(dispersion_result$estimate, 4), "\n")
if (dispersion_result$p.value < 0.05) {
  cat("Дүгнэлт: Хэт дисперстэй (overdispersion) байна.\n")
} else {
  cat("Дүгнэлт: Хэт дисперстэй биш.\n")
}
```

Пуассоны регресс хэт дисперстэй өгөгдөлд тохирохгүй тул урвасан бином загвар @roback2021beyond ашиглана.

```{r}
#| warning: false
# Урвасан бином регресс
data$loss_amount <- pmax(0.1, data$loss_amount)
# Бүхэл тоо болгох
data$loss_amount_int <- round(pmax(1, data$loss_amount))

# Өгөгдлийг шалгах
if (any(is.na(data$loss_amount_int)) || any(is.infinite(data$loss_amount_int))) {
  data$loss_amount_int[is.na(data$loss_amount_int) | is.infinite(data$loss_amount_int)] <- 1
}

# Урвасан бином регресс
# Түүврийн хэмжээ бага тул init.theta параметр ашиглах
suppressWarnings({
  model_loss_nb <- tryCatch({
    MASS::glm.nb(loss_amount_int ~ year, data = data, 
                 control = glm.control(maxit = 50),
                 init.theta = 10,
                 link = log)
  }, error = function(e) {
    # Алдаа гарвал энгийн glm ашиглах
    glm(loss_amount_int ~ year, data = data, family = poisson(link = "log"))
  })
})

cat("Negative Binomial Regression Model:\n")
cat("Coefficients:\n")
print(coef(model_loss_nb))
if (inherits(model_loss_nb, "negbin")) {
  cat("\nTheta (dispersion parameter):", model_loss_nb$theta, "\n")
}
cat("AIC:", AIC(model_loss_nb), "\n")

# McFadden R²
if (inherits(model_loss_nb, "negbin")) {
  suppressWarnings({
    model_loss_null <- tryCatch({
      MASS::glm.nb(loss_amount_int ~ 1, data = data, 
                   control = glm.control(maxit = 50),
                   init.theta = 10,
                   link = log)
    }, error = function(e) {
      glm(loss_amount_int ~ 1, data = data, family = poisson(link = "log"))
    })
  })
  
  log_lik_nb_full <- logLik(model_loss_nb)
  log_lik_nb_null <- logLik(model_loss_null)
  mcfadden_r2_nb <- 1 - (as.numeric(log_lik_nb_full) / as.numeric(log_lik_nb_null))
  cat("Урвасан бином регрессийн McFadden R² =", round(mcfadden_r2_nb, 4), "\n")
} else {
  cat("McFadden R² тооцоолох боломжгүй (Poisson регресс ашигласан)\n")
}
```

```{r}
conclusion <- append(conclusion,
  r"(Банк, санхүүгийн байгууллагын алдагдлын хэмжээнд
  хэт дисперстэй тархалтын загвар тохирно.)"
)
```

Прогноз гаргахад шаардлагатай регрессийн загварууд бэлэн болсон тул одоо ойрын хэдэн жилийн зээлийн эрсдэл, алдагдлын хэмжээний прогноз гаргах руу чиглэнэ.

# Зээлийн эрсдэл, алдагдлын прогноз

Өгөгдөл 2019-2023 оны хооронд байгаа тул 2024 оноос эхлэн гурван жилийн прогноз гаргана.

```{r}
#| label: tbl-prediction
#| tbl-cap: Зээлийн эрсдэл, алдагдлын ойрын ирээдүйн прогноз

# Ирээдүйн жилүүд
future_years <- data.frame(year = 2024:2026)

# Прогноз үнэлэх
future_years$predicted_risk_linear <- predict(model_risk, newdata = future_years, type = "response")
future_years$predicted_risk_logistic <- predict(model_risk_logistic, newdata = future_years, type = "response") * 100
future_years$predicted_loss <- predict(model_loss_nb, newdata = future_years, type = "response")

knitr::kable(
  data.frame(
    Он = future_years$year,
    "Эрсдэлтэй зээлийн хувь - Шугаман (%)" = round(future_years$predicted_risk_linear, 2),
    "Эрсдэлтэй зээлийн хувь - Ложистик (%)" = round(future_years$predicted_risk_logistic, 2),
    "Алдагдлын хэмжээ (мянган)" = round(future_years$predicted_loss, 0)
  ),
  col.names = c("Он", "Эрсдэлтэй зээлийн хувь - Шугаман (%)", "Эрсдэлтэй зээлийн хувь - Ложистик (%)", "Алдагдлын хэмжээ (мянган)")
)
```

```{r}
conclusion <- append(conclusion, sprintf(
  r"(Банк, санхүүгийн байгууллагын зээлийн эрсдэлтэй зээлийн хувь
  2026 онд шугаман регрессээр %.2f%%, ложистик регрессээр %.2f%% байна гэсэн прогноз гарсан.)", 
  future_years$predicted_risk_linear[future_years$year == 2026],
  future_years$predicted_risk_logistic[future_years$year == 2026]
))

conclusion <- append(conclusion, sprintf(
  r"(Банк, санхүүгийн байгууллагын алдагдлын хэмжээ
  2026 онд %.0f мянган байна гэсэн прогноз гарсан.)", 
  future_years$predicted_loss[future_years$year == 2026]
))
```

```{r}
#| echo: false

# График зурхад ашиглах өгөгдөл
all_years <- data.frame(year = 2019:2026)
all_years$predicted_risk_linear <- predict(model_risk, newdata = all_years, type = "response")
all_years$predicted_risk_logistic <- predict(model_risk_logistic, newdata = all_years, type = "response") * 100
all_years$predicted_loss <- predict(model_loss_nb, newdata = all_years, type = "response")
```

```{r}
#| results: hide

Cairo::CairoPDF(
  file = file.path(output_dir, "fig-prediction.pdf"),
  family = "Times New Roman", width = 8, height = 5
)

par(mfrow = c(1, 2))

# Эрсдэлтэй зээлийн хувь
plot(
  data$year, data$risk_ratio,
  xlim = c(2019, 2026),
  ylim = range(c(data$risk_ratio, all_years$predicted_risk_linear, all_years$predicted_risk_logistic)),
  xlab = "Он", ylab = "Эрсдэлтэй зээлийн хувь (%)",
  pch = 16, col = "blue",
  main = "Эрсдэлтэй зээлийн хувь"
)

lines(all_years$year, all_years$predicted_risk_linear, col = "darkgreen", lwd = 2, lty = 1)
lines(all_years$year, all_years$predicted_risk_logistic, col = "orange", lwd = 2, lty = 2)

points(
  future_years$year,
  future_years$predicted_risk_linear,
  pch = 16, col = "red"
)

points(
  future_years$year,
  future_years$predicted_risk_logistic,
  pch = 17, col = "purple"
)

legend(
  "topleft",
  legend = c("Ажиглалт", "Шугаман регресс", "Ложистик регресс", "Прогноз (шугаман)", "Прогноз (ложистик)"),
  col = c("blue", "darkgreen", "orange", "red", "purple"),
  pch = c(16, NA, NA, 16, 17),
  lty = c(NA, 1, 2, NA, NA),
  lwd = c(NA, 2, 2, NA, NA),
  cex = 0.8
)

# Алдагдлын хэмжээ
plot(
  data$year, data$loss_amount,
  xlim = c(2019, 2026),
  ylim = range(c(data$loss_amount, all_years$predicted_loss)),
  xlab = "Он", ylab = "Алдагдлын хэмжээ (мянган)",
  pch = 16, col = "blue",
  main = "Алдагдлын хэмжээ"
)

lines(all_years$year, all_years$predicted_loss, col = "darkgreen", lwd = 2)

points(
  future_years$year,
  future_years$predicted_loss,
  pch = 16, col = "red"
)

legend(
  "topleft",
  legend = c("Ажиглалт", "Загвар (2019–2026)", "Прогноз (2024–2026)"),
  col = c("blue", "darkgreen", "red"),
  pch = c(16, NA, 16),
  lty = c(NA, 1, NA),
  lwd = c(NA, 2, NA)
)

dev.off()
```

```{r}
#| label: fig-prediction
#| fig-cap: Зээлийн эрсдэл, алдагдлын хэмжээ ба регрессийн загвар

knitr::include_graphics(file.path(output_dir, "fig-prediction.pdf"))
```

```{r}
risk_2026_linear <- future_years$predicted_risk_linear[future_years$year == 2026]
risk_2026_logistic <- future_years$predicted_risk_logistic[future_years$year == 2026]
risk_2020 <- data$risk_ratio[data$year == 2020]
risk_increase_linear <- round((risk_2026_linear - risk_2020) / risk_2020 * 100, 1)
risk_increase_logistic <- round((risk_2026_logistic - risk_2020) / risk_2020 * 100, 1)

loss_2026 <- future_years$predicted_loss[future_years$year == 2026]
loss_2020 <- data$loss_amount[data$year == 2020]
loss_increase <- round((loss_2026 - loss_2020) / loss_2020 * 100, 1)

conclusion <- append(conclusion, sprintf(
  r"(2026 онд эрсдэлтэй зээлийн хувь 2020 онтой харьцуулбал шугаман регрессээр %.1f%%-аар,
  ложистик регрессээр %.1f%%-аар, алдагдлын хэмжээ %.1f%%-аар өсөхөөр байна. 
  Ирээдүйд шинэ өгөгдөл ирсэн үед тооны хандлагыг ахин шалгах хэрэгтэй.)", 
  risk_increase_linear, risk_increase_logistic, loss_increase
))

rm(risk_2026_linear, risk_2026_logistic, risk_2020, risk_increase_linear, risk_increase_logistic, loss_2026, loss_2020, loss_increase)
```

# Дүгнэлт {.unnumbered}

```{r}
#| results: asis

for (i in seq_along(conclusion)) {
  cat(paste0(i, ". ", conclusion[i], "\n"))
}; rm(i)
```

# Ашигласан материал {.unnumbered}

::: {#refs}
:::

